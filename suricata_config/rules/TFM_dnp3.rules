alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:established; content:"|05 64|"; msg: "DNP3 TFM: Comunicacion no DNP3 al puerto DNP3"; sid:201; rev:1; priority:1;)
alert tcp any any -> $DNP3_SERVER 20000 (flow:established; content:"|15|"; offset:12; depth:1; msg:"DNP3 TFM: deshabilitacion de respuestas no solicitadas "; sid:202; rev:1; priority:1;)
alert tcp $DNP3_SERVER 20000 -> $DNP3_CLIENT any (flow:from_server, established; content:"|82|"; offset:12; depth:1; msg:"DNP3 TFM: tormenta de respuestas no solicitadas "; threshold: type threshold, track by_src, count 5, seconds 10; sid:203; rev:1; priority:2;) 
alert tcp $DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:from_client, established; content:"|0D|"; offset:12; depth:1; msg:"DNP3 TFM: peticion de reinicio en frio desde cliente autorizado "; sid:204; rev:1; priority:1;)
alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:established; content:"|12|"; offset:12; depth:1; msg:"DNP3 TFM: solicitud de paro por parte de cliente no autorizado "; sid:205; rev:1; priority:1;)
alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:established; content:"|0E|"; offset:12; depth:1; msg:"DNP3 TFM: peticion de warm Restart por parte de cliente no autorizado "; sid:206; rev:1; priority:1;)
alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:established; content:"|05 64|"; depth:2; pcre:"/[\S\s]{10}(\x02|\x04|\x05|\x06|\x09|\x0A|\x0F|\x12)/iAR"; msg: "DNP3 TFM: solicitud de escritura por cliente no autorizado"; sid:207; rev:1; priority:1;)
alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:established; content:"|05 64|"; depth:2; pcre:"/[\S\s]{10}(\x03|\x07|\x08|\x0B|\x0C|\x10|\x11|\x13|\x14|\x15|\x16|\x17|\x18|\x19|\x1A|\x1B|\x1C|\x1D|\x1E)/iAR"; msg: "DNP3 TFM:solicitud de ejecucion de comandos por parte de cliente no autorizado"; sid:208; rev:1; priority:1;)
alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:established; content:"|FF FF|"; offset:4; depth:2; msg:"DNP3 TFM: peticiones broadcast desde clientes no autorizados"; sid:209; rev:1; priority:1;)
alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:established; content:"|01|"; offset:12; depth:1; msg:"DNP3 TFM: solicitud de Cold Restart desde cliente no autorizado"; sid:210; rev:1; priority:1;)
alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:established; content:"|01|"; offset:12; depth:1; msg:"DNP3 TFM: solicitud de lectura desde cliente no autorizado "; sid:211; rev:1; priority:1;)
alert tcp $DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:from_client, established; content:"|01|"; offset:12; depth:1; msg:"DNP3 TFM: solicitud broadcast desde clientes autorizados"; sid:212; rev:1; priority:1;)
alert tcp $DNP3_CLIENT any -> !$DNP3_SERVER 20000 (flow:from_client, established; msg:"DNP3 TFM: comunicacion desde cliente a equipo no autorizado"; sid:213; rev:1; priority:1;)
alert tcp $DNP3_CLIENT any -> $DNP3_SERVER 20000 (flow:from_client, established; msg:"DNP3 TFM: Comunicacion legitima cliente-servidor"; sid:214; rev:1; priority:2;)
alert tcp $DNP3_SERVER 20000 -> $DNP3_CLIENT any (flow:from_server, established; msg:"DNP3 TFM: Comunicacion legitima servidor-cliente"; sid:215; rev:1; priority:2;)


alert tcp !$IEC104_CLIENT any -> $IEC104_SERVER 2404 (content:!"|68|"; msg:"IEC104 TFM: paquete no iec104 en puerto iec104"; sid:001; rev:1; priority:1;)
alert tcp !$IEC104_CLIENT any -> $IEC104_SERVER !2404 (msg:"IEC104 TFM:   conexion a puerto no definido en iec104 server"; sid:002; rev:1; priority:1;)
alert tcp $IEC104_CLIENT any -> !$IEC104_SERVER 2404 (msg:"IEC104 TFM: comunicacion cliente no autorizada"; sid:003; rev:1; priority:1;)
alert tcp $IEC104_CLIENT any -> $IEC104_SERVER !2404 (msg:"IEC104 TFM: comunicacion hacia servidor no autorizada"; sid:004; rev:1; priority:1;)
alert tcp $IEC104_CLIENT any -> $IEC104_SERVER 2404 (flow:from_client, established; content:"|68|"; offset:0; depth:1; byte_test:1, !&, 1, 2; pcre:"/[\S\s]{5}(!\x00)/iAR"; msg:"IEC104 TFM: campo type identification no definido"; sid:005; rev:1; priority:1;)
alert tcp $IEC104_SERVER 2404 -> $IEC104_CLIENT any (flow:from_server, established; content:"|68|"; offset:0; depth:1; byte_test:1, !&, 1, 2; pcre:"/[\S\s]{5}(!\x00)/iAR"; msg:"IEC104 TFM: campo type identification no definido"; sid:006; rev:1; priority:1;)
alert tcp $IEC104_CLIENT 2404 -> $IEC104_SERVER any (flow:from_client, established; content:"|68|"; offset:0; depth:1; byte_test:1, !&, 1, 2; pcre:"/[\S\s]{5}(![\x80-\xFF])/iAR"; msg:"IEC104 TFM: campo type identification no definido"; sid:007; rev:1; priority:1;)
alert tcp $IEC104_SERVER 2404 -> $IEC104_CLIENT any (flow:from_server, established; content:"|68|"; offset:0; depth:1; byte_test:1, !&, 1, 2; pcre:"/[\S\s]{5}(![\x80-\xFF])/iAR"; msg:"IEC104 TFM: campo type identification no definido"; sid:008; rev:1; priority:1;)
alert tcp $IEC104_CLIENT any -> $IEC104_SERVER 2404 (flow:from_client, established; content:"|68|"; offset:0; depth:1; byte_test:1, !&, 1, 2; pcre:"/[\S\s]{5}(?![\x2D-\x33]|[\x3A-\x40]|[\x64-\x67]|\x69|\x6B|[\x6E-\x71])/iAR"; msg:"IEC104 TFM: campo type identification no valido"; sid:009; rev:1; priority:1;)
alert tcp $IEC104_CLIENT any -> $IEC104_SERVER 2404 (flow:from_client, established; content:"|68|"; offset:0; depth:1; byte_test:1, !&, 1, 2; pcre:"/[\S\s]{5}(?!\x01|\x03|\x05|\x07|\x09|\x0B|\x0D|\x0F|\x14|\x14|[\x1E-x28]|\x46|[\x2D-\x33]|[\x3A-\x40]|[\x64-\x67]|\x69|\x6B|[\x6E-\x71])/iAR"; msg:"IEC104 TFM: campo type identification no valido"; sid:010; rev:1; priority:1;)
alert tcp $IEC104_CLIENT any -> $IEC104_SERVER 2404 (flow:from_client, established; content:"|68|"; offset:0; depth:1; pcre:"/[\S\s]{5}(\x2D|\x2E|\x2F|\x30|\x64|\x65)/iAR"; content:!"|06|"; offset: 8; depth: 1; msg:"IEC104 TFM: valor CoT invalido en sentido control"; sid:011; rev:1; priority:1;)
alert tcp $IEC104_SERVER 2404 -> $IEC104_CLIENT any (flow:from_server, established; content:"|68|"; offset:0; depth:1; pcre:"/[\S\s]{5}(\x2D|\x2E|\x2F|\x30|\x64|\x65)/iAR"; content:!"|07|"; offset: 8; depth: 1; content:!"|0A|"; offset: 8; depth: 1; msg:"IEC104 TFM: valor CoT invalido en sentido monitor 1"; sid:012; rev:1; priority:1;)
alert tcp $IEC104_SERVER 2404 -> $IEC104_CLIENT any (flow:from_server, established; content:"|68|"; offset: 8; depth: 1; pcre:"/[\S\s]{5}(![\x01-x0D]|[\x14-x29])/iAR"; msg:"IEC104 TFM: valor CoT invalido en sentido monitor"; sid:014; rev:1; priority:1;)
alert tcp $IEC104_SERVER 2404 -> $IEC104_CLIENT any (flow:from_server, established; content:"|68|"; offset: 8; depth: 1; pcre:"/[\S\s]{5}([\x0E-x13])/iAR"; msg:"IEC104 TFM: valor CoT reservado"; sid:015; rev:1; priority:1;)
alert tcp !$IEC104_CLIENT any -> $IEC104_SERVER !2404 (msg:"IEC104 TFM: comunicacion no autorizada hacia el servidor"; sid:016; rev:1; priority:1;)
alert tcp $IEC104_CLIENT any -> $IEC104_SERVER 2404 (msg:"IEC104 TFM: Comunicacion legitima cliente-servidor"; sid:017; rev:1; priority:2;)
alert tcp $IEC104_SERVER 2404 -> $IEC104_CLIENT any (msg:"IEC104 TFM: Comunicacion legitima servidor-cliente"; sid:018; rev:1; priority:2;)


